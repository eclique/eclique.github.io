<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<img id="testImage" src='img.png' style="display: none;"/>

<h3>Modified Image</h3>
<div style="position: relative;">
 <canvas id="canvas1" width="100" height="100"
   style="position: absolute; left: 0; top: 0; z-index: 0;"></canvas>
 <canvas id="canvas2" width="100" height="100"
   style="position: absolute; left: 0; top: 0; z-index: 1;"></canvas>
</div>

<script>
setTimeout(function(){
  var canvas1 = document.getElementById("canvas1"),
      ctx1 = canvas1.getContext("2d"),
      image = document.getElementById("testImage"),
      canvas2 = document.getElementById("canvas2"),
      ctx2 = canvas2.getContext("2d");

  canvas1.height = canvas1.width = 274;
  canvas2.height = canvas2.width = 274;
  ctx1.drawImage(image,0,0);
  // ctx1.fillStyle="#FF000088";
  // ctx1.fillRect(20,20,150,100);
  ctx2.fillStyle="#000000";
  ctx2.fillRect(0,0,274,274);

  var imgd = ctx2.getImageData(0, 0, 274, 274),
      pix = imgd.data;

  for (var i = 0, n = pix.length; i <n; i += 4) {
      // if(r == 255&& g == 255 && b == 255){
      if (i < 50000) {
          // Change the white to the new color.
          // pix[i] = newColor.r;
          // pix[i+1] = newColor.g;
          // pix[i+2] = newColor.b;
          pix[i+3] = 0;
      }
  }
  ctx2.putImageData(imgd, 0, 0);

  // var imgd = ctx.getImageData(0, 0, 274, 274),
  //     pix = imgd.data,
  //     newColor = {r:100,g:0,b:0, a:255};
  //
  // for (var i = 0, n = pix.length; i <n; i += 4) {
  //     var r = pix[i],
  //         g = pix[i+1],
  //         b = pix[i+2];
  //
  //     // // if(r == 255&& g == 255 && b == 255){
  //     // if (i < 2) {
  //     //     // Change the white to the new color.
  //     //     pix[i] = newColor.r;
  //     //     pix[i+1] = newColor.g;
  //     //     pix[i+2] = newColor.b;
  //     //     pix[i+3] = newColor.a;
  //     // }
  //     // else {
  //     //   pix[i+3] = 255;
  //     // }
  // }
  //
  // ctx.putImageData(imgd, 0, 0);
}, 20);
</script>
